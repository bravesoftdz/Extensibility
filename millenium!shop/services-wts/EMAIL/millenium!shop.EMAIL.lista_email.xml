<?xml version="1.0"?>
<root>
  <OBJECT NAME="EMAIL">
    <METHOD NAME="lista_email" DESCRIPTION="" VERSION="4" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="status" FORMAT="N" SIZE="8" FLAGS="1" DEFAULT="2" PROJECTION="0" LOOKUP="list:'0','Enviado';'1','Aguardando Envio';'2','N&#227;o Enviado (Erro)';" FIELDLABEL="Status" CTAB="0"/>
        <PARAM NAME="DATA" FORMAT="D" SIZE="10" FLAGS="17" DEFAULT="TODAY" PROJECTION="0" FIELDLABEL="Data" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="ID" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Id" CTAB="0"/>
        <FIELD NAME="DATE_EMAIL" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" FIELDLABEL="Date Email" CTAB="0"/>
        <FIELD NAME="E_MAIL_TO" SIZE="100" FLAGS="1" PROJECTION="0" FIELDLABEL="E Mail To" CTAB="0"/>
        <FIELD NAME="SUBJECT" SIZE="100" FLAGS="1" PROJECTION="0" FIELDLABEL="Subject" CTAB="0"/>
        <FIELD NAME="STATUS_MESSAGE" SIZE="5000" FLAGS="1" PROJECTION="0" FIELDLABEL="Status Message" CTAB="0"/>
        <FIELD NAME="MAC_ADDRESS" SIZE="200" FLAGS="1" PROJECTION="0" FIELDLABEL="Mac Address" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT MD.MSG_DADOS AS ID,
       MD.MAC_ADDRESS,
       MU.DATA_REC AS DATE_EMAIL,
       MD.DESCRICAO AS SUBJECT,
       LOWER(MU.NOME) AS E_MAIL_TO,
       MU.MSG AS STATUS_MESSAGE
FROM MSG_DADOS MD
INNER JOIN MSG_USUARIOS MU ON (MU.MSG_DADOS = MD.MSG_DADOS)
WHERE MD.TIPO = 'email' AND
      #SELECT(STATUS,0:{STATUS = 'E'},1:{STATUS = 'P' AND MSG IS NULL},2:{STATUS IN ('P','R') AND MSG IS NOT NULL})
      AND MU.DATA_REC>=:DATA
ORDER BY MD.MSG_DADOS
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>