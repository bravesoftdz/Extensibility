<?xml version="1.0"?>
<root>
  <OBJECT NAME="PEDIDO_VENDA">
    <METHOD NAME="HasPrefatSKU" DESCRIPTION="" VERSION="6" INTFTYPE="5" TRIGGEROF="PEDIDO_VENDA.HasPrefatSKU" TRIGGERTYPE="0" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="PEDIDOV" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Pedidov" CTAB="0"/>
        <PARAM NAME="PRODUTO" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Produto" CTAB="0"/>
        <PARAM NAME="COR" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Cor" CTAB="0"/>
        <PARAM NAME="ESTAMPA" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Estampa" CTAB="0"/>
        <PARAM NAME="TAMANHO" SIZE="5" PROJECTION="0" FIELDLABEL="Tamanho" CTAB="0"/>
        <PARAM NAME="VOID" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Void" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>SELECT
 COUNT(V.CT) as resultado
FROM
(
SELECT 'T' AS CT FROM
 PREFATURAMENTOS P
INNER JOIN PRODUTO_PREFAT PPF ON PPF.PREFATURAMENTO = P.PREFATURAMENTO AND PPF.PRODUTO = :PRODUTO AND PPF.COR = :COR AND PPF.ESTAMPA = :ESTAMPA AND PPF.TAMANHO = :TAMANHO
INNER JOIN PEDIDO_VENDA PV ON (PV.PEDIDOV = P.PEDIDOV)
WHERE
 P.PEDIDOV = :PEDIDOV  AND
 P.PELO_PEDIDO = TRUE AND
 P.EXCLUIDO = FALSE AND
 PV.EM_DIGITACAO = FALSE
HAVING SUM(PPF.QUANTIDADE-PPF.ENTREGUE) &lt;> 0
) V
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>