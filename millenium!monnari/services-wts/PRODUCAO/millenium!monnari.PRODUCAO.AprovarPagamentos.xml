<?xml version="1.0"?>
<root>
  <OBJECT NAME="PRODUCAO">
    <METHOD NAME="AprovarPagamentos" DESCRIPTION="Aprovar Pagamentos" VERSION="16" INTFTYPE="17" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="MOVIMENTO_PRODUCAO" FORMAT="R" PROJECTION="0" FIELDLABEL="Lancamentos" NESTEDNAME="WTSSYSTEM.INTERNALTYPES.STRINGARRAY" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>#EACH() MOVIMENTO_PRODUCAO AS M
#BEGIN
  UPDATE MOVIMENTO_PRODUCAO SET MNR_SITUACAO_AUT = 1 WHERE MOVIMENTO_PRODUCAO IN (#REPLACE(:M.ITEM));
  
  #EACH() SELECT:MP MOVIMENTO_PRODUCAO
          FROM MOVIMENTO_PRODUCAO
          WHERE MOVIMENTO_PRODUCAO IN (#REPLACE(:M.ITEM))
          #BEGIN
              INSERT INTO MNR_HIST_SITUACAO_AUT (MOVIMENTO_PRODUCAO,DATA,DESCRICAO,USUARIO)
                                         VALUES (:MP.MOVIMENTO_PRODUCAO,#DATE(),'AUTORIZA&#199;&#195;O DE PAGAMENTO',#USER())
                             #RETURN(HIST_SITUACAO_AUT);
          #END;
                         
#END;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>