CREATE OR ALTER VIEW VW_SIM_CLIENTE(
    CNPJ_CPF_CLIENTE,
    IE_CLIENTE,
    RAZAO_SOCIAL,
    NOME_FANTASIA,
    TELEFONE,
    EMAIL_CLIENTE,
    LOGRADOURO_CLIENTE,
    BAIRRO_CLIENTE,
    CIDADE_CLIENTE,
    ESTADO_CLIENTE,
    CEP_CLIENTE,
    DATA_ATUALIZACAO)
AS
SELECT IIF(COALESCE(CL.PAIS,0)=0,TRIM(REPLACE(REPLACE(REPLACE(IIF(CL.PF_PJ = 'PF', CL.CPF, CL.CNPJ), '.', ''), '-', ''), '/', '')),9999||10||PADLEFT(CL.cod_cliente,8,'0')) AS CNPJ_CPF_CLIENTE,
       CL.IE AS IE_CLIENTE,
       CL.NOME AS RAZAO_SOCIAL,
       CL.FANTASIA AS NOME_FANTASIA,
       COALESCE(EC.DDD, "") || COALESCE(EC.FONE, "") AS TELEFONE,
       CL.E_MAIL AS EMAIL_CLIENTE,
       EC.LOGRADOURO AS LOGRADOURO_CLIENTE,
       EC.BAIRRO AS BAIRRO_CLIENTE,
       EC.CIDADE AS CIDADE_CLIENTE,
       EC.ESTADO AS ESTADO_CLIENTE,
       EC.CEP AS CEP_CLIENTE,
       CL.DATA_ATUALIZACAO

       PAISES

FROM CLIENTES CL
LEFT JOIN ENDERECOS_CADASTRO EC ON (EC.GERADOR = CL.GERADOR) AND (EC.ENDERECO_NOTA = 'T');