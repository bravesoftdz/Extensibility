CREATE OR ALTER VIEW VW_SIM_PRAZOS_PAGTO(
    CONDICOES_PGTO,
    PRAZO)
AS
WITH RECURSIVE CTE_PRAZOS_PAG  AS (

SELECT CP1.CONDICOES_PGTO, CP1.CONDICOES_PGTO AS PAI, CP1.PRAZO
FROM CONDICOES_PGTO CP1
WHERE CP1.PRINCIPAL IS NULL

UNION ALL

SELECT VW.PAI AS CONDICOES_PGTO, NULL AS PAI, CP2.PRAZO
FROM CONDICOES_PGTO CP2
INNER JOIN CTE_PRAZOS_PAG VW ON (VW.PAI = CP2.PRINCIPAL))

SELECT CONDICOES_PGTO,PRAZO FROM CTE_PRAZOS_PAG
ORDER BY CONDICOES_PGTO
;