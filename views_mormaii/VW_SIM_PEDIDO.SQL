CREATE OR ALTER VIEW VW_SIM_PEDIDO(
    IDENTIFICADOR_DO_PEDIDO,
    CODIGO_FILIAL,
    CODIGO_PEDIDO,
    EMAIL_CLIENTE,
    TELEFONE_CLIENTE,
    DATA_EMISSAO,
    TIPO_DE_MOEDA,
    CPF_CNPJ_CLIENTE,
    CPF_CNPJ_REPRESENTANTE,
    CONDICOES_PAGAMENTO,
    OBSERVACOES,
    DATA_HORA_ATUALIZACAO)
AS
SELECT PV.PEDIDOV AS IDENTIFICADOR_DO_PEDIDO,
       FI.COD_FILIAL AS CODIGO_FILIAL,
       PV.COD_PEDIDOV AS CODIGO_PEDIDO,
       CL.E_MAIL AS EMAIL_CLIENTE,
       EC.DDD||'-'||EC.FONE AS TELEFONE_CLIENTE,
       PV.DATA_EMISSAO AS DATA_EMISSAO,
       'R$' AS  TIPO_DE_MOEDA,
       TRIM(REPLACE(REPLACE(REPLACE(IIF(CL.PF_PJ='PF',CL.CPF,CL.CNPJ),'.',''),'-',''),'/','')) AS CPF_CNPJ_CLIENTE,
       TRIM(REPLACE(REPLACE(REPLACE(IIF(RE.PF_PJ='PF',RE.CPF,RE.CNPJ),'.',''),'-',''),'/','')) AS CPF_CNPJ_REPRESENTANTE,
       (SELECT LIST(PZ.PRAZO,'/') FROM VW_SIM_PRAZOS_PAGTO PZ WHERE PZ.CONDICOES_PGTO = CP.CONDICOES_PGTO) AS CONDICOES_PAGAMENTO,
       PV.OBS AS OBSERVACOES,
       PV.DATA_ATUALIZACAO_WEB AS DATA_HORA_ATUALIZACAO
FROM PEDIDO_VENDA PV
INNER JOIN FILIAIS FI ON (FI.FILIAL=PV.FILIAL)
INNER JOIN CLIENTES CL ON (CL.CLIENTE = PV.CLIENTE)
INNER JOIN CONDICOES_PGTO CP ON (CP.CONDICOES_PGTO = PV.CONDICOES_PGTO)
LEFT JOIN ENDERECOS_CADASTRO EC ON (EC.GERADOR = CL.GERADOR) AND
                                   (EC.COD_ENDERECO = PV.COD_ENDERECO)
LEFT JOIN REPRESENTANTES RE ON (RE.REPRESENTANTE = PV.REPRESENTANTE)
;