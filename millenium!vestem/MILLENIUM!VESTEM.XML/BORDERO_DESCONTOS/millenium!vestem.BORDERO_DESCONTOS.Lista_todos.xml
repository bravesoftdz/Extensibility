<?xml version="1.0"?>
<root>
  <OBJECT NAME="BORDERO_DESCONTOS">
    <METHOD NAME="Lista_todos" DESCRIPTION="Lista Borderos em Geral" VERSION="1" INTFTYPE="5" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="DATAI" FORMAT="D" SIZE="10" FLAGS="17" DEFAULT="TODAY-30" PROJECTION="0" ORDER="2" FIELDLABEL="Data Inicial" CTAB="0"/>
        <PARAM NAME="DATAF" FORMAT="D" SIZE="10" FLAGS="17" DEFAULT="TODAY" PROJECTION="0" ORDER="3" FIELDLABEL="Data Final" CTAB="0"/>
        <PARAM NAME="SCRIPTBANCO" SIZE="255" FLAGS="1" STYLE="4" PROJECTION="0" ORDER="4" LOOKUP="millenium.BANCOS.ListaMeusBancos" LOOKUPKEY="BANCO" LOOKUPDISPLAY="NOME" LOOKUPCODE="COD_BANCO" FIELDLABEL="Bancos" CTAB="0"/>
        <PARAM NAME="ORDEM" FORMAT="N" SIZE="1" FLAGS="1" DEFAULT="0" PROJECTION="0" ORDER="1" LOOKUP="list:'0','C&#243;digo';'1','Descricao';'2','Banco';'3','Data';" FIELDLABEL="Ordem" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="COD_BORDERO" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Cod Bordero" CTAB="0"/>
        <FIELD NAME="DESCRICAO" SIZE="60" FLAGS="1" PROJECTION="0" ORDER="11" FIELDLABEL="Descricao" CTAB="0"/>
        <FIELD NAME="DATA" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="Data" CTAB="0"/>
        <FIELD NAME="BANCO" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="Banco" CTAB="0"/>
        <FIELD NAME="BORDERO" FORMAT="N" SIZE="8" FLAGS="8" PROJECTION="0" FIELDLABEL="Bordero" CTAB="0"/>
        <FIELD NAME="BORDERO_LANCAMENTOS" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Bordero Lancamentos" CTAB="0"/>
        <FIELD NAME="DESC_CONTA" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Desc Conta" CTAB="0"/>
        <FIELD NAME="TIPO_CARTEIRA" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Tipo da Carteira" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT MIN(BORDERO.COD_BORDERO) AS COD_BORDERO,
       MIN(BORDERO.DESCRICAO) AS DESCRICAO,
       BORDERO.DATA,
       MIN((BANCOS.COD_BANCO || ' - ' || BANCOS.NOME)) AS BANCO,
       BORDERO.BORDERO,
       MIN(CONTAS.NUMERO) AS DESC_CONTA,
       #TRANSLATE(MIN(CARTEIRAS.TIPO_CARTEIRA),
                   "S": "Simples",
                   "D": "Descontada",
                   "C": "Caucionada",
                  else: "     -    ") AS TIPO_CARTEIRA

FROM BORDERO
     LEFT JOIN BANCOS
          ON BORDERO.BANCO=BANCOS.BANCO
     LEFT JOIN CONTAS
          ON BORDERO.CONTA_COBRANCA=CONTAS.CONTA
     LEFT JOIN CARTEIRAS
          ON BORDERO.CARTEIRA = CARTEIRAS.CARTEIRA
WHERE BORDERO.DATA BETWEEN #REPLACET(:DATAI) AND #REPLACET(:DATAF)
      [ AND BANCOS.BANCO IN #REPLACE(:SCRIPTBANCO) ]
GROUP BY BORDERO.BORDERO, BORDERO.DATA
ORDER BY #SELECT(ORDEM,
                 0:bordero.COD_BORDERO,
                 1:bordero.DESCRICAO,
                 2:{bancos.BANCO,bordero.COD_BORDERO},
                 3:{bordero.DATA,bordero.COD_BORDERO})
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>