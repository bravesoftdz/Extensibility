<?xml version="1.0"?>
<root>
  <OBJECT NAME="B2B">
    <METHOD NAME="ListaRepresentantes" DESCRIPTION="Lista Representantes" VERSION="24" INTFTYPE="5" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="REPRESENTANTE" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="1" FIELDLABEL="Representante" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="REPRESENTANTE" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" HINT="Id do representante" ORDER="8" FIELDLABEL="Representante" CTAB="0"/>
        <FIELD NAME="COD_REPRESENTANTE" SIZE="15" FLAGS="1" PROJECTION="0" HINT="C&#243;digo do representante" ORDER="3" FIELDLABEL="Cod Representante" CTAB="0"/>
        <FIELD NAME="NOME" SIZE="60" FLAGS="1" PROJECTION="0" HINT="Nome do representante" ORDER="7" FIELDLABEL="Nome" CTAB="0"/>
        <FIELD NAME="DESATIVADO" FORMAT="B" SIZE="1" FLAGS="1" PROJECTION="0" HINT="Ativado ou desativado na empresa" ORDER="4" FIELDLABEL="Desativado" CTAB="0"/>
        <FIELD NAME="E_MAIL" SIZE="40" FLAGS="1" PROJECTION="0" ORDER="5" FIELDLABEL="E Mail" CTAB="0"/>
        <FIELD NAME="KEY" SIZE="40" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="Key" CTAB="0"/>
        <FIELD NAME="FANTASIA" SIZE="120" FLAGS="1" PROJECTION="0" FIELDLABEL="Fantasia" CTAB="0"/>
        <FIELD NAME="TIPO_COMISSAO" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" FIELDLABEL="Tipo Comissao" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT
  R.REPRESENTANTE,
  R.COD_REPRESENTANTE,
  R.FANTASIA,
  R.NOME,
  R.E_MAIL,
  COALESCE(R.SENHA_PDA,(SUBSTR(R.CGC,1,2)||SUBSTR(R.CGC,4,3))) AS KEY,
  R.DESATIVADO,
  TIPO_COMISSAO
FROM
  REPRESENTANTES R
WHERE R.PF_PJ = 'PJ'
AND ENVIA_PDA ='T'
AND R.CGC IS NOT NULL
AND E_MAIL LIKE '%@%'
AND R.NOME NOT LIKE '%INATIVO%'
AND R.REPRESENTANTE &lt;> -2000000000
AND [REPRESENTANTE=:REPRESENTANTE]

UNION ALL

SELECT
  R.REPRESENTANTE,
  R.COD_REPRESENTANTE,
  R.NOME,
  R.FANTASIA,
  R.E_MAIL,
  COALESCE(R.SENHA_PDA,(SUBSTR(R.CPF,1,3)||SUBSTR(R.CPF,5,2))) AS KEY,
  R.DESATIVADO,
  TIPO_COMISSAO
FROM
  REPRESENTANTES R
WHERE R.PF_PJ = 'PF'
AND ENVIA_PDA ='T'
AND R.CPF IS NOT NULL
AND E_MAIL LIKE '%@%'
AND R.NOME NOT LIKE '%INATIVO%'
AND R.REPRESENTANTE &lt;> -2000000000
AND [REPRESENTANTE=:REPRESENTANTE]
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>