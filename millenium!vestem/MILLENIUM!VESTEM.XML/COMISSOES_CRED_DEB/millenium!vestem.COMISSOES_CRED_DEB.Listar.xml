<?xml version="1.0"?>
<root>
  <OBJECT NAME="COMISSOES_CRED_DEB">
    <METHOD NAME="Listar" DESCRIPTION="Listar - Cr&#233;dito/D&#233;bito" VERSION="44" INTFTYPE="14" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="COD_CREDITO" SIZE="6" FLAGS="1" PROJECTION="0" ORDER="2" FIELDLABEL="C&#243;digo" CTAB="0"/>
        <PARAM NAME="DATA_VENC_I" FORMAT="D" SIZE="10" FLAGS="1" DEFAULT="TODAY" PROJECTION="0" ORDER="5" FIELDLABEL="Data Vencimento Inicial" CTAB="0"/>
        <PARAM NAME="DATA_VENC_F" FORMAT="D" SIZE="10" FLAGS="1" DEFAULT="TODAY" PROJECTION="0" ORDER="6" FIELDLABEL="Data Vencimento Final" CTAB="0"/>
        <PARAM NAME="TIPO" SIZE="1" FLAGS="1" DEFAULT="T" PROJECTION="0" ORDER="1" LOOKUP="list:'C','Cr&#233;dito';'D','D&#233;bito';'T','Ambos';" FIELDLABEL="Tipo" CTAB="0"/>
        <PARAM NAME="GERADOR" SIZE="1" FLAGS="1" DEFAULT="R" PROJECTION="0" ORDER="3" LOOKUP="MILLENIUM.TIPO_GERADOR.LISTA" LOOKUPKEY="TIPO_GERADOR" LOOKUPDISPLAY="DESCRICAO" FIELDLABEL="Tipo de gerador" CTAB="0"/>
        <PARAM NAME="COD" FORMAT="N" SIZE="8" FLAGS="1" STYLE="5" PROJECTION="0" ORDER="4" LOOKUP="MILLENIUM.TITULOS.Lista_Gerador_Popup" LOOKUPKEY="COD" LOOKUPDISPLAY="NOME" LOOKUPCODE="CODIGO" FIELDLABEL="Gerador" CTAB="0"/>
        <PARAM NAME="FILIAL" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="9" LOOKUP="MILLENIUM.FILIAIS.LISTA" LOOKUPKEY="FILIAL" LOOKUPDISPLAY="FANTASIA" LOOKUPCODE="COD_FILIAL" FIELDLABEL="Filial" CTAB="0"/>
        <PARAM NAME="TIPO_PGTO" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="10" LOOKUP="MILLENIUM.TIPOS_PGTOS.Lista" LOOKUPKEY="TIPO_PGTO" LOOKUPDISPLAY="DESCRICAO" FIELDLABEL="Tipo Pgto" CTAB="0"/>
        <PARAM NAME="DATA_EMISSAO_I" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Data Emiss&#227;o Inicial" CTAB="0"/>
        <PARAM NAME="DATA_EMISSAO_F" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Data Emiss&#227;o Final" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="COMISSAO_CRED_DEB" FORMAT="N" SIZE="8" FLAGS="8" PROJECTION="0" FIELDLABEL="Cod Credito" CTAB="0"/>
        <FIELD NAME="COD_CREDITO" SIZE="6" FLAGS="1" PROJECTION="0" ORDER="12" FIELDLABEL="C&#243;digo" CTAB="0"/>
        <FIELD NAME="DATA_EMISSAO" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="18" FIELDLABEL="Data de emiss&#227;o" CTAB="0"/>
        <FIELD NAME="DATA_VENCIMENTO" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="19" FIELDLABEL="Data de vencimento" CTAB="0"/>
        <FIELD NAME="DATA_DIGITACAO" FORMAT="H" SIZE="18" PROJECTION="0" FIELDLABEL="Data Digitacao" CTAB="0"/>
        <FIELD NAME="TIPO" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="16" FIELDLABEL="Tipo" CTAB="0"/>
        <FIELD NAME="VALOR" FORMAT="M" SIZE="17" FLAGS="1" DECIMALS="4" PROJECTION="0" ORDER="20" FIELDLABEL="Valor" CTAB="0"/>
        <FIELD NAME="GERADOR" SIZE="20" FLAGS="9" PROJECTION="0" ORDER="14" FIELDLABEL="Gerador" CTAB="0"/>
        <FIELD NAME="DESC_GERADOR" SIZE="60" FLAGS="1" PROJECTION="0" ORDER="13" FIELDLABEL="Gerador" CTAB="0"/>
        <FIELD NAME="OBS" FLAGS="1" PROJECTION="0" ORDER="21" FIELDLABEL="Obs" CTAB="0"/>
        <FIELD NAME="DESC_FILIAL" SIZE="60" FLAGS="1" PROJECTION="0" ORDER="15" FIELDLABEL="Empresa" CTAB="0"/>
        <FIELD NAME="TIPO_PGTO" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="17" FIELDLABEL="Tipo Pgto" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT
   E.COMISSAO_CRED_DEB
  ,E.COD_CREDITO
  ,E.DATA_EMISSAO
  ,E.DATA_VENCIMENTO
  ,E.VALOR
  ,E.OBS
  ,#TRANSLATE(E.TIPO,"C":"Cr&#233;dito","D": "D&#233;bito") AS TIPO
  ,#TRANSLATE(E.GERADOR,"R": "Representante",else: "ND") AS GERADOR
  ,min(F.COD_FILIAL)||' - '||min(F.FANTASIA) AS DESC_FILIAL
  ,min(r.cod_representante)||' - '||min(r.FANTASIA) AS DESC_GERADOR
  ,min(TP.DESCRICAO) AS TIPO_PGTO
  ,#TRANSLATE(E.TIPO,"C":"Cr&#233;dito","D": "D&#233;bito") AS TIPO
  ,#TRANSLATE(E.GERADOR,"R": "Representante",else: "ND") AS GERADOR
FROM EVL_COMISSOES_CRED_DEB E
  INNER JOIN FILIAIS F ON F.FILIAL = E.FILIAL
  INNER JOIN tipos_pgtos tp on tp.tipo_pgto = e.tipo_pgto
  left JOIN  REPRESENTANTES R ON R.representante = E.cod AND E.gerador = 'R'
WHERE E.EXCLUIDO = FALSE
  [AND E.COD_CREDITO=:COD_CREDITO]
  [AND E.DATA_VENCIMENTO BETWEEN :DATA_VENC_I AND :DATA_VENC_F]
  [AND E.DATA_EMISSAO BETWEEN :DATA_EMISSAO_I AND :DATA_EMISSAO_F]
  [AND E.FILIAL=:FILIAL]

  #select(TIPO, 'C':{ and E.tipo = 'C'},
                'D':{ and E.tipo = 'D'},
                 else:{})
  
group by 1,2,3,4,5,6,7,8
;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>