<?xml version="1.0"?>
<root>
  <OBJECT NAME="TIPOS">
    <METHOD NAME="Lista" DESCRIPTION="Lista Tipos com Filtro" VERSION="24" INTFTYPE="8" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="ORDEM" FORMAT="N" SIZE="1" FLAGS="17" DEFAULT="0" PROJECTION="0" ORDER="1" LOOKUP="list:'0','DESCRI&#199;&#195;O';'1','C&#211;DIGO';" FIELDLABEL="Ordem" CTAB="0"/>
        <PARAM NAME="CAMPO" FORMAT="N" SIZE="1" FLAGS="17" DEFAULT="1" PROJECTION="0" ORDER="2" LOOKUP="list:'0','DESCRI&#199;&#195;O';'1','C&#211;DIGO';" FIELDLABEL="Campo" CTAB="0"/>
        <PARAM NAME="FILTRO" FORMAT="N" SIZE="1" FLAGS="17" DEFAULT="2" PROJECTION="0" ORDER="3" LOOKUP="list:'0','>=';'1','&lt;=';'2','=';'3','&lt;>';'4','~=';" FIELDLABEL="Filtro" CTAB="0"/>
        <PARAM NAME="VALOR_FILTRO" SIZE="25" FLAGS="1" PROJECTION="0" ORDER="4" FIELDLABEL="Valor" CTAB="0"/>
        <PARAM NAME="VALOR_1" SIZE="25" FLAGS="1" PROJECTION="0" ORDER="5" FIELDLABEL="Entre" CTAB="0"/>
        <PARAM NAME="VALOR_2" SIZE="25" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="e" CTAB="0"/>
        <PARAM NAME="DEPARTAMENTO" FORMAT="N" SIZE="8" FLAGS="2" PROJECTION="0" FIELDLABEL="Departamento" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="TIPO" FORMAT="N" SIZE="8" FLAGS="8" PROJECTION="0" FIELDLABEL="Tipo" CTAB="0"/>
        <FIELD NAME="CODIGO" SIZE="5" FLAGS="17" PROJECTION="0" ORDER="8" FIELDLABEL="C&#243;digo" CTAB="0"/>
        <FIELD NAME="DESCRICAO" SIZE="50" FLAGS="17" PROJECTION="0" ORDER="9" FIELDLABEL="Descri&#231;&#227;o" CTAB="0"/>
        <FIELD NAME="DESC_DEPARTAMENTO" SIZE="35" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Departamento" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT  TIPO, COD_TIPO AS CODIGO, TIPOS.DESCRICAO, DEPARTAMENTOS.DESCRICAO AS DESC_DEPARTAMENTO
FROM TIPOS LEFT JOIN DEPARTAMENTOS ON TIPOS.DEPARTAMENTO=DEPARTAMENTOS.DEPARTAMENTO
Where 
#SELECT( VALOR_FILTRO, NULL:{},
  ELSE:{[AND #SELECT(CAMPO,0:TIPOS.DESCRICAO,1:COD_TIPO) #SELECT(FILTRO,4:{LIKE #REPLACETR(VALOR_FILTRO)},
                           ELSE:{#SELECT(FILTRO,0:'>=',1:'&lt;=',2:'=',3:'&lt;>') :VALOR_FILTRO})]
  })
[AND #SELECT(CAMPO,0:TIPOS.DESCRICAO,1:COD_TIPO) >= :VALOR_1] 
[AND #SELECT(CAMPO,0:TIPOS.DESCRICAO,1:COD_TIPO) &lt;= :VALOR_2] 
[AND ((TIPO IN (SELECT CD.CLASSIFICACAO_FILHO
               FROM CLASSIFICACOES_DEPENDENCIAS CD
               WHERE CD.TIPO_PAI = '2' AND
                     CD.CLASSIFICACAO_PAI = :DEPARTAMENTO AND
                     CD.TIPO_FILHO = '3'))
               OR (SELECT COUNT(*)
                   FROM CLASSIFICACOES_DEPENDENCIAS CD
                   WHERE CD.TIPO_PAI = '2' AND
                         CD.CLASSIFICACAO_PAI = :DEPARTAMENTO AND
                         CD.TIPO_FILHO = '3')=0) ]
ORDER BY #SELECT(ORDEM,0:TIPOS.DESCRICAO,1:COD_TIPO)
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>