<?xml version="1.0"?>
<root>
  <OBJECT NAME="INSPECOES">
    <METHOD NAME="Lista" DESCRIPTION="Fases Aguardando Inspe&#231;&#227;o" VERSION="35" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="PRODUTO" FORMAT="N" SIZE="8" FLAGS="1" STYLE="5" PROJECTION="0" ORDER="1" LOOKUP="MILLENIUM.PRODUTOS.LISTA_POPUP3" LOOKUPKEY="PRODUTO" LOOKUPDISPLAY="DESCRICAO" LOOKUPCODE="CODIGO" FIELDLABEL="Produto" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="PRODUCAO" FORMAT="N" SIZE="8" PROJECTION="0" ORDER="5" FIELDLABEL="Ordem" CTAB="0"/>
        <FIELD NAME="FICHA_TECNICA" FORMAT="N" SIZE="8" PROJECTION="0" ORDER="4" FIELDLABEL="N Ordem" CTAB="0"/>
        <FIELD NAME="FASE" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Fase" CTAB="0"/>
        <FIELD NAME="N_ORDEM" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="7" FIELDLABEL="Ordem" CTAB="0"/>
        <FIELD NAME="COD_PRODUTO" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="3" FIELDLABEL="Produto" CTAB="0"/>
        <FIELD NAME="DESC_PROD" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="4" FIELDLABEL="Descri&#231;&#227;o" CTAB="0"/>
        <FIELD NAME="DATA_INICIO" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="5" FIELDLABEL="Data" CTAB="0"/>
        <FIELD NAME="QUANTIDADE" FORMAT="N" SIZE="8" FLAGS="1" PROJECTION="0" ORDER="8" FIELDLABEL="Quantidade" CTAB="0"/>
        <FIELD NAME="UNIDADE_USO" SIZE="5" FLAGS="1" PROJECTION="0" ORDER="9" FIELDLABEL="UM" CTAB="0"/>
        <FIELD NAME="DESC_FASE" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="10" FIELDLABEL="Fase" CTAB="0"/>
        <FIELD NAME="COD_PEDIDOV" SIZE="20" FLAGS="1" PROJECTION="0" ORDER="11" FIELDLABEL="N&#186; Pedido Venda" CTAB="0"/>
        <FIELD NAME="DATA_ENTREGA" FORMAT="D" SIZE="10" FLAGS="1" PROJECTION="0" ORDER="12" FIELDLABEL="Data Entrega" CTAB="0"/>
        <FIELD NAME="NOME_CLIENTE" SIZE="50" FLAGS="1" PROJECTION="0" ORDER="6" FIELDLABEL="Cliente" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>SELECT PDC.PRODUCAO,
       PDC.FICHA_TECNICA,
       PDC.N_ORDEM,
       PROD.COD_PRODUTO,
       PROD.DESCRICAO1 DESC_PROD,
       SP.DATA_INICIO,
       SP.QUANTIDADE,
       PROD.UNIDADE_USO,
       FA.DESCRICAO AS DESC_FASE,
       PV.COD_PEDIDOV,
       PV.DATA_ENTREGA,
       C.NOME AS NOME_CLIENTE,
       FA.FASE
FROM PRODUCAO PDC
INNER JOIN SITUACAO_PRODUCAO SP ON (SP.PRODUCAO = PDC.PRODUCAO)
INNER JOIN FASES FA ON (FA.FASE =SP.FASE)
INNER JOIN FICHAS_TECNICAS FT ON (FT.FICHA_TECNICA = PDC.FICHA_TECNICA)
INNER JOIN PRODUTOS PROD ON (PROD.PRODUTO = FT.PRODUTO)
INNER JOIN DCA_FASES DF ON (DF.FASE = FA.FASE) AND (PERMITE_INSPECAO = TRUE)
LEFT JOIN PEDIDOS_PRODUCAO PP ON (PP.PRODUCAO = PDC.PRODUCAO)
LEFT JOIN PEDIDO_VENDA PV ON (PV.PEDIDOV = PP.PEDIDO)
LEFT JOIN CLIENTES C ON (C.CLIENTE = PV.CLIENTE)
WHERE  NOT EXISTS(SELECT 1 FROM DCA_INSPECOES INSP WHERE INSP.PRODUCAO = PDC.PRODUCAO AND INSP.FASE = SP.FASE)
       [AND PROD.PRODUTO = :PRODUTO]
ORDER BY DATA_INICIO;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>