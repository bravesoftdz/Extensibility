<?xml version="1.0"?>
<root>
  <OBJECT NAME="MOVIMENTACAO">
    <METHOD NAME="Executa" DESCRIPTION="" VERSION="17" TRIGGEROF="MOVIMENTACAO.EXECUTA" TRIGGERTYPE="0" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="SI_ORDENS_SERVICO" FORMAT="R" FLAGS="1" PROJECTION="0" FIELDLABEL="Ordens Servico" NESTEDNAME="WTSSYSTEM.INTERNALTYPES.INTEGERARRAY" CTAB="0"/>
        <PARAM NAME="EVENTO" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Evento" CTAB="0"/>
        <PARAM NAME="ROMANEIO" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Romaneio" CTAB="0"/>
        <PARAM NAME="CLIENTE" FORMAT="N" SIZE="8" PROJECTION="0" LOOKUP="MILLENIUM.CLIENTES.Lista_FiltroPopup" LOOKUPKEY="CLIENTE" LOOKUPDISPLAY="NOME" LOOKUPCODE="COD_CLIENTE" FIELDLABEL="Cliente" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>SELECT:MOV COD_OPERACAO, TIPO_OPERACAO FROM MOVIMENTO
WHERE ROMANEIO=:ROMANEIO AND
      EVENTO=:EVENTO AND
      CLIENTE=:CLIENTE;
      
#EACH() SI_ORDENS_SERVICO AS OS
#BEGIN
  UPDATE SI_ORDENS_SERVICO SET STATUS = #IF(STATUS=1,2,5) WHERE ORDEM_SERVICO=:OS.ITEM;
  
  INSERT INTO SI_ORDENS_SERVICO_NFS (ORDEM_SERVICO,TIPO_OPERACAO,COD_OPERACAO)
                             VALUES (:OS.ITEM,:MOV.TIPO_OPERACAO,:MOV.COD_OPERACAO)
                             #RETURN(ORDEM_SERVICO_NF);
#END;
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>