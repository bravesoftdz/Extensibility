<?xml version="1.0"?>
<root>
  <OBJECT NAME="ORDENS_SERVICO">
    <METHOD NAME="ReAgrupar" DESCRIPTION="Reagrupar Ordens Servi&#231;o" VERSION="10" INTFTYPE="17" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="ORDENS_SERVICO" FORMAT="R" PROJECTION="0" FIELDLABEL="Ordens Servico" NESTEDNAME="WTSSYSTEM.INTERNALTYPES.INTEGERARRAY" CTAB="0"/>
        <PARAM NAME="COD_GRUPO" SIZE="5" FLAGS="17" DEFAULT="millenium.utils.default(['SI_COD_GRUPO_SERVICO',5],'Result',True)" PROJECTION="0" ORDER="1" FIELDLABEL="N&#176; Grupo da Ordem" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="ORDEM_SERVICO" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Ordem Servico" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>#CHECK("SELECT COUNT(GRUPO) AS N FROM SI_ORDENS_SERVICO WHERE GRUPO =:COD_GRUPO", N>0, "C&#243;digo de grupo j&#225; utilizado. Caso queira agrupar mais ordens ao grupo j&#225; existe, 'desagrupe' e agrupe todos juntos.");

UPDATE SI_ORDENS_SERVICO SET GRUPO=:COD_GRUPO
WHERE ORDEM_SERVICO IN #MAKELIST(ORDENS_SERVICO,ITEM);

SELECT ORDEM_SERVICO FROM SI_ORDENS_SERVICO
WHERE ORDEM_SERVICO IN #MAKELIST(ORDENS_SERVICO,ITEM);


</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>