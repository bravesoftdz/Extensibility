<?xml version="1.0"?>
<root>
  <OBJECT NAME="ORDENS_SERVICO">
    <METHOD NAME="Agrupar" DESCRIPTION="Agrupar Ordens Servi&#231;o" VERSION="19" INTFTYPE="17" THREADSAFE="1">
      <PARAMS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <PARAM NAME="ORDENS_SERVICO" FORMAT="R" PROJECTION="0" FIELDLABEL="Ordens Servico" NESTEDNAME="WTSSYSTEM.INTERNALTYPES.INTEGERARRAY" CTAB="0"/>
      </PARAMS>
      <FIELDS>
        <GROUPS>
          <GROUP/>
        </GROUPS>
        <FIELD NAME="ORDEM_SERVICO" FORMAT="N" SIZE="8" PROJECTION="0" FIELDLABEL="Ordem Servico" CTAB="0"/>
      </FIELDS>
      <ACTIONSCRIPT>#CHECK("SELECT COUNT(COD_ORDEM_SERVICO) AS N FROM SI_ORDENS_SERVICO WHERE ORDEM_SERVICO IN #MAKELIST(ORDENS_SERVICO,ITEM) AND GRUPO IS NOT NULL", N>0, "Existe alguma ordem de servi&#231;o selecionada j&#225; est&#225; agrupada!");

#CALL:CTC millenium.utils.default(NOME="SI_GRUPO_ORDEM_SERVICO",TAMANHO=5,TAM_REQUESTED=TRUE);

UPDATE SI_ORDENS_SERVICO SET GRUPO=:CTC.RESULT
WHERE ORDEM_SERVICO IN #MAKELIST(ORDENS_SERVICO,ITEM);

SELECT ORDEM_SERVICO FROM SI_ORDENS_SERVICO
WHERE ORDEM_SERVICO IN #MAKELIST(ORDENS_SERVICO,ITEM);


</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>